import t,{useEffect as e,useRef as o,useMemo as r,useState as a}from"react";import s from"./image.skeleton";import i from"../use-real-shape";import m from"../use-current-state";import c from"../use-resize";import{StyledImage as n,StyledImageContainer as u}from"./image.styles";import l from"../utils/clsx";import{jsx as p}from"react/jsx-runtime";import{jsxs as h}from"react/jsx-runtime";const d=({src:t,width:d,height:f,showSkeleton:x,className:g,maxDelay:w,autoResize:y,objectFit:j,containerCss:b,css:N,...k})=>{const[z,F]=a(!0),[S,T]=a(x),{w:$,h:D}=r((()=>({w:d?"number"==typeof d?`${d}px`:d:"auto",h:f?"number"==typeof f?`${f}px`:f:"auto"})),[d,f]),[R,C,L]=m(D),P=o(null),[q,v]=i(P),A=x&&!!d&&!!f;e((()=>{A&&P.current&&P.current.complete&&(F(!1),T(!1))})),e((()=>{const t=setTimeout((()=>{A&&T(!1),clearTimeout(t)}),w);return()=>clearTimeout(t)}),[z]),e((()=>{if(!y)return;const t=0===q.width,e="auto"===L.current;!t&&d&&f&&(q.width<d?!e&&C("auto"):e&&C(D))}),[q,d]),c((()=>{y&&v()}));const B=r((()=>z?"loading":"ready"),[z]);return h(u,{className:l("nextui-image-container",`nextui-image--${B}`,g),"data-state":B,ready:!z,css:{...b,width:$,height:R},children:[S&&p(s,{opacity:1}),p(n,{ref:P,className:"nextui-image",width:d,height:f,onLoad:()=>{F(!1)},src:t,"data-state":B,alt:k.alt||"",css:{objectFit:j,...N},...k})]})};d.toString=()=>".nextui-image",d.defaultProps={showSkeleton:!0,autoResize:!1,objectFit:"scale-down",maxDelay:3e3,className:""};export default t.memo(d);