import{KeyMod as e}from"./codes";import{useEffect as t}from"react";import{getActiveModMap as r,getCtrlKeysByPlatform as n}from"./helper";export default(o,p,s={})=>{const a=Array.isArray(p)?p:[p],{disableGlobalEvent:y=!1,capture:i=!1,stopPropagation:l=!1,preventDefault:d=!1,event:u="keydown"}=s,m=r(a),C=a.filter((t=>!e[t])),{CtrlCmd:f,WinCtrl:c}=n(),k=e=>{m.Shift&&!e.shiftKey||m.Alt&&!e.altKey||m.CtrlCmd&&!e[f]||m.WinCtrl&&!e[c]||C.length>0&&!C.includes(e.keyCode)||(l&&e.stopPropagation(),d&&e.preventDefault(),o&&o(e))};t((()=>(y||document.addEventListener(u,k),()=>{document.removeEventListener(u,k)})),[y]);const K=(e,t=!1)=>e!==u||t!==i?()=>{}:e=>k(e);return{bindings:{onKeyDown:K("keydown"),onKeyDownCapture:K("keydown",!0),onKeyPress:K("keypress"),onKeyPressCapture:K("keypress",!0),onKeyUp:K("keyup"),onKeyUpCapture:K("keyup",!0)}}};