{"ast":null,"code":"var _jsxFileName = \"/Users/gianningamy/cryptobet/front-end/refactoring/src/Components/CurrentGame.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useContext } from \"react\";\nimport { abi } from \"../Config/abi\";\nimport { UserContext } from \"../Provider/UserProvider\";\nimport styled from \"styled-components\";\nimport Web3 from \"web3\";\nimport { ADDRESS } from \"../Config/contract\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst CurrentGame = ({\n  idCurrentGame\n}) => {\n  _s();\n\n  const web3 = new Web3(window.ethereum);\n  const {\n    user: userInfos,\n    userLoading,\n    setUser\n  } = useContext(UserContext);\n  let contract = new web3.eth.Contract(abi, ADDRESS);\n  const [gameInfos, setGameInfos] = useState(\"\");\n\n  async function getGameInfos(idGame) {\n    var game; // var statusGame\n\n    var currentPrice;\n    var currentGameId = idGame;\n    await contract.methods.Games(currentGameId).call().then(function (receipt) {\n      game = receipt;\n    });\n    await contract.methods.getCurrentPrice().call().then(function (receipt) {\n      currentPrice = receipt / 10 ** 8;\n    });\n    var min = String((game.endTimestamp - Math.floor(Date.now() / 1000)) % 60);\n    if (min < 10) min = \"0\" + min;\n    var priceStart = 0;\n\n    if (currentGameId !== 0) {\n      await contract.methods.Games(parseInt(currentGameId) - 1).call().then(function (receipt) {\n        priceStart = receipt.priceEnd / 10 ** 8;\n      });\n    }\n\n    var state = (currentPrice - priceStart).toFixed(3);\n\n    if (state > 0) {\n      state = \"UP\";\n    } else {\n      if (state < 0) {\n        state = \"DOWN\";\n      } else {\n        state = \"---\";\n      }\n    }\n\n    var user = await contract.methods.users(currentGameId, userInfos.account).call();\n    var poolChoice = user.poolChoice;\n    if (poolChoice == 1) poolChoice = \"UP\";else poolChoice = \"DOWN\";\n    setGameInfos({\n      Pool1Amount: await web3.utils.fromWei(game.upAmount, \"ether\"),\n      Pool0Amount: await web3.utils.fromWei(game.downAmount, \"ether\"),\n      Pool1Payout: parseFloat(game.upAmount) > 0 ? ((parseFloat(game.upAmount) + parseFloat(game.downAmount)) / parseFloat(game.upAmount)).toFixed(2) : \"1.00\",\n      Pool0Payout: parseFloat(game.downAmount) > 0 ? ((parseFloat(game.upAmount) + parseFloat(game.downAmount)) / parseFloat(game.downAmount)).toFixed(2) : \"1.00\",\n      priceStart: priceStart.toFixed(3),\n      CurrentPrice: currentPrice.toFixed(3),\n      CurrentGameId: currentGameId,\n      playerState: parseInt(user.amount) > 0 ? poolChoice + \" : \" + (await web3.utils.fromWei(user.amount, \"ether\")) + \" MATIC\" : \"OUT\",\n      State: state,\n      previousTime: game.endTimestamp,\n      min: min,\n      TimeLeft: Math.floor((game.endTimestamp - Math.floor(Date.now() / 1000)) / 60) >= 0 ? \"Time left : \" + String(Math.floor((game.endTimestamp - Math.floor(Date.now() / 1000)) / 60)) + \" : \" + min : \"Calculating\"\n    });\n  }\n\n  const [counter, setCounter] = useState(0);\n  useEffect(() => {\n    getGameInfos(idCurrentGame);\n  }, []);\n  return /*#__PURE__*/_jsxDEV(Container, {\n    style: gameInfos.State === \"UP\" ? {\n      border: \"3px solid rgb(39, 255, 96)\"\n    } : {\n      border: \"3px solid rgb(255, 67, 67)\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(StatusContainer, {\n      children: [/*#__PURE__*/_jsxDEV(State, {\n        children: \"Live\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(Time, {\n        children: gameInfos.TimeLeft\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(Id, {\n        children: [\"#\", gameInfos.CurrentGameId]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(Up, {\n      style: gameInfos.State === \"UP\" ? {} : {\n        background: \"linear-gradient(90deg, rgb(206, 162, 206) 0%, rgb(149, 177, 254) 100%)\",\n        color: \"rgb(84, 36, 50)\",\n        border: \"3px solid rgb(84, 36, 50)\"\n      },\n      children: [\"UP x\", gameInfos.Pool1Payout, \" Payout\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(StatsContainer, {\n      children: [/*#__PURE__*/_jsxDEV(Stats, {\n        children: [/*#__PURE__*/_jsxDEV(Key, {\n          children: \"Current ETH price\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(Value, {\n          style: gameInfos.State === \"UP\" ? {\n            border: \"3px solid rgb(39, 255, 96)\"\n          } : {\n            border: \"3px solid rgb(255, 67, 67)\"\n          },\n          children: [gameInfos.CurrentPrice, \" $\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(Stats, {\n        children: [/*#__PURE__*/_jsxDEV(Key, {\n          children: \"Locked ETH price\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(Value, {\n          children: [gameInfos.priceStart, \" $\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(Stats, {\n        children: [/*#__PURE__*/_jsxDEV(Key, {\n          children: \"Prize pool\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(Value, {\n          children: [parseFloat(gameInfos.Pool0Amount) + parseFloat(gameInfos.Pool1Amount) > 0 ? (parseFloat(gameInfos.Pool0Amount) + parseFloat(gameInfos.Pool1Amount)).toFixed(2) : 0, \" \", \"MATIC\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(Down, {\n      style: gameInfos.State === \"DOWN\" ? {} : {\n        background: \"linear-gradient(90deg, rgb(206, 162, 206) 0%, rgb(149, 177, 254) 100%)\",\n        color: \"rgb(84, 36, 50)\",\n        border: \"3px solid rgb(84, 36, 50)\"\n      },\n      children: [\"DOWN x\", gameInfos.Pool0Payout, \" Payout\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(OutputContainer, {\n      children: /*#__PURE__*/_jsxDEV(Output, {\n        children: gameInfos.playerState\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 5\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 91,\n    columnNumber: 3\n  }, this);\n};\n\n_s(CurrentGame, \"Tsw8tl8da3H11fK81ev1pHdQ0AY=\");\n\n_c = CurrentGame;\nconst Container = styled.div`\n\tbackground-image: linear-gradient(90deg, rgb(206, 162, 206) 0%, rgb(149, 177, 254) 100%);\n\tcolor: rgb(84, 36, 50);\n\tmargin-top: 5rem;\n\twidth: 400px;\n\theight: 350px;\n\tborder-radius: 1rem;\n\tdisplay: flex;\n\tflex-direction: column;\n\tfont-family: Inter, sans-serif;\n\tflex-direction: column;\n`;\n_c2 = Container;\nconst StatusContainer = styled.div`\n\tbackground-color: #191b1f;\n\tborder: #191b1f;\n\tpadding: 0.5rem;\n\tborder-radius: 0.5rem;\n\tdisplay: flex;\n\twidth: 100%;\n\theight: 100%;\n`;\n_c3 = StatusContainer;\nconst State = styled.div`\n\twidth: 33%;\n\ttext-align: center;\n\tcolor: rgb(149, 177, 254);\n`;\n_c4 = State;\nconst Time = styled.div`\n\twidth: 33%;\n\ttext-align: center;\n\tcolor: rgb(149, 177, 254);\n`;\n_c5 = Time;\nconst Id = styled.div`\n\twidth: 33%;\n\ttext-align: center;\n\tcolor: rgb(149, 177, 254);\n`;\n_c6 = Id;\nconst Up = styled.div`\n\tpadding: 0.5rem;\n\tborder-radius: 0.5rem;\n\twidth: 100%;\n\tborder: 3px solid rgb(39, 255, 96);\n\tbackground: rgb(149, 177, 254);\n\tcolor: rgb(39, 255, 96);\n\ttext-align: center;\n`;\n_c7 = Up;\nconst Down = styled.div`\n\tpadding: 0.5rem;\n\tborder-radius: 0.5rem;\n\twidth: 100%;\n\tborder: 3px solid rgb(255, 67, 67);\n\tbackground: rgb(206, 162, 206);\n\tcolor: rgb(255, 67, 67);\n\ttext-align: center;\n`;\n_c8 = Down;\nconst StatsContainer = styled.div`\n\tbackground-color: #191b1f;\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tjustify-content: center;\n\tborder-radius: 0.5rem;\n`;\n_c9 = StatsContainer;\nconst Stats = styled.div`\n\tpadding: 0.7rem;\n\tborder-radius: 0.5rem;\n\tdisplay: flex;\n\twidth: 100%;\n`;\n_c10 = Stats;\nconst Key = styled.div`\n\tbackground-color: rgb(33, 36, 41);\n\tborder: 1px solid rgb(33, 36, 41);\n\tpadding: 0.5rem;\n\tborder-radius: 0.5rem;\n\twidth: 100%;\n\ttext-align: center;\n\tcolor: rgb(149, 177, 254);\n`;\n_c11 = Key;\nconst Value = styled.div`\n\tcolor: rgb(149, 177, 254);\n\tborder: 1px solid rgb(33, 36, 41);\n\tpadding: 0.5rem;\n\tborder-radius: 0.5rem;\n\twidth: 60%;\n\ttext-align: center;\n`;\n_c12 = Value;\nconst OutputContainer = styled.div`\n\tbackground-image: linear-gradient(90deg, rgb(206, 162, 206) 0%, rgb(149, 177, 254) 100%);\n\tborder: 1px solid linear-gradient(90deg, rgb(206, 162, 206) 0%, rgb(149, 177, 254) 100%);\n\tpadding: 0.5rem;\n\tborder-radius: 0.5rem;\n\twidth: 100%;\n\theight: 10%;\n\tjustify-content: center;\n`;\n_c13 = OutputContainer;\nconst Output = styled.p`\n\ttext-align: center;\n`;\n_c14 = Output;\nexport default CurrentGame;\n\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7, _c8, _c9, _c10, _c11, _c12, _c13, _c14;\n\n$RefreshReg$(_c, \"CurrentGame\");\n$RefreshReg$(_c2, \"Container\");\n$RefreshReg$(_c3, \"StatusContainer\");\n$RefreshReg$(_c4, \"State\");\n$RefreshReg$(_c5, \"Time\");\n$RefreshReg$(_c6, \"Id\");\n$RefreshReg$(_c7, \"Up\");\n$RefreshReg$(_c8, \"Down\");\n$RefreshReg$(_c9, \"StatsContainer\");\n$RefreshReg$(_c10, \"Stats\");\n$RefreshReg$(_c11, \"Key\");\n$RefreshReg$(_c12, \"Value\");\n$RefreshReg$(_c13, \"OutputContainer\");\n$RefreshReg$(_c14, \"Output\");","map":{"version":3,"sources":["/Users/gianningamy/cryptobet/front-end/refactoring/src/Components/CurrentGame.jsx"],"names":["React","useState","useEffect","useContext","abi","UserContext","styled","Web3","ADDRESS","CurrentGame","idCurrentGame","web3","window","ethereum","user","userInfos","userLoading","setUser","contract","eth","Contract","gameInfos","setGameInfos","getGameInfos","idGame","game","currentPrice","currentGameId","methods","Games","call","then","receipt","getCurrentPrice","min","String","endTimestamp","Math","floor","Date","now","priceStart","parseInt","priceEnd","state","toFixed","users","account","poolChoice","Pool1Amount","utils","fromWei","upAmount","Pool0Amount","downAmount","Pool1Payout","parseFloat","Pool0Payout","CurrentPrice","CurrentGameId","playerState","amount","State","previousTime","TimeLeft","counter","setCounter","border","background","color","Container","div","StatusContainer","Time","Id","Up","Down","StatsContainer","Stats","Key","Value","OutputContainer","Output","p"],"mappings":"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AAGrE,MAAM,CAACiE,GAAI;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CARA;MAAMI,E;AAUN,MAAMC,IAAI,GAAGtE,MAAM,CAACiE,GAAI;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CARA;MAAMK,I;AAUN,MAAMC,cAAc,GAAGvE,MAAM,CAACiE,GAAI;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,CAPA;MAAMM,c;AASN,MAAMC,KAAK,GAAGxE,MAAM,CAACiE,GAAI;AACzB;AACA;AACA;AACA;AACA,CALA;OAAMO,K;AAON,MAAMC,GAAG,GAAGzE,MAAM,CAACiE,GAAI;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CARA;OAAMQ,G;AAUN,MAAMC,KAAK,GAAG1E,MAAM,CAACiE,GAAI;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,CAPA;OAAMS,K;AASN,MAAMC,eAAe,GAAG3E,MAAM,CAACiE,GAAI;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CARA;OAAMU,e;AAUN,MAAMC,MAAM,GAAG5E,MAAM,CAAC6E,CAAE;AACxB;AACA,CAFA;OAAMD,M;AAIN,eAAezE,WAAf","sourcesContent":["import React, { useState, useEffect, useContext } from \"react\"\nimport { abi } from \"../Config/abi\"\nimport { UserContext } from \"../Provider/UserProvider\"\nimport styled from \"styled-components\"\nimport Web3 from \"web3\"\nimport { ADDRESS } from \"../Config/contract\"\n\nconst CurrentGame = ({ idCurrentGame }) => {\n\tconst web3 = new Web3(window.ethereum)\n\tconst { user: userInfos, userLoading, setUser } = useContext(UserContext)\n\tlet contract = new web3.eth.Contract(abi, ADDRESS)\n\n\tconst [gameInfos, setGameInfos] = useState(\"\")\n\n\tasync function getGameInfos(idGame) {\n\t\tvar game\n\t\t// var statusGame\n\t\tvar currentPrice\n\t\tvar currentGameId = idGame\n\n\t\tawait contract.methods\n\t\t\t.Games(currentGameId)\n\t\t\t.call()\n\t\t\t.then(function (receipt) {\n\t\t\t\tgame = receipt\n\t\t\t})\n\n\t\tawait contract.methods\n\t\t\t.getCurrentPrice()\n\t\t\t.call()\n\t\t\t.then(function (receipt) {\n\t\t\t\tcurrentPrice = receipt / 10 ** 8\n\t\t\t})\n\n\t\tvar min = String((game.endTimestamp - Math.floor(Date.now() / 1000)) % 60)\n\t\tif (min < 10) min = \"0\" + min\n\n\t\tvar priceStart = 0\n\t\tif (currentGameId !== 0) {\n\t\t\tawait contract.methods\n\t\t\t\t.Games(parseInt(currentGameId) - 1)\n\t\t\t\t.call()\n\t\t\t\t.then(function (receipt) {\n\t\t\t\t\tpriceStart = receipt.priceEnd / 10 ** 8\n\t\t\t\t})\n\t\t}\n\n\t\tvar state = (currentPrice - priceStart).toFixed(3)\n\t\tif (state > 0) {\n\t\t\tstate = \"UP\"\n\t\t} else {\n\t\t\tif (state < 0) {\n\t\t\t\tstate = \"DOWN\"\n\t\t\t} else {\n\t\t\t\tstate = \"---\"\n\t\t\t}\n\t\t}\n\n\t\tvar user = await contract.methods.users(currentGameId, userInfos.account).call()\n\t\tvar poolChoice = user.poolChoice\n\t\tif (poolChoice == 1) poolChoice = \"UP\"\n\t\telse poolChoice = \"DOWN\"\n\n\t\tsetGameInfos({\n\t\t\tPool1Amount: await web3.utils.fromWei(game.upAmount, \"ether\"),\n\t\t\tPool0Amount: await web3.utils.fromWei(game.downAmount, \"ether\"),\n\t\t\tPool1Payout:\n\t\t\t\tparseFloat(game.upAmount) > 0 ? ((parseFloat(game.upAmount) + parseFloat(game.downAmount)) / parseFloat(game.upAmount)).toFixed(2) : \"1.00\",\n\t\t\tPool0Payout:\n\t\t\t\tparseFloat(game.downAmount) > 0\n\t\t\t\t\t? ((parseFloat(game.upAmount) + parseFloat(game.downAmount)) / parseFloat(game.downAmount)).toFixed(2)\n\t\t\t\t\t: \"1.00\",\n\t\t\tpriceStart: priceStart.toFixed(3),\n\t\t\tCurrentPrice: currentPrice.toFixed(3),\n\t\t\tCurrentGameId: currentGameId,\n\t\t\tplayerState: parseInt(user.amount) > 0 ? poolChoice + \" : \" + (await web3.utils.fromWei(user.amount, \"ether\")) + \" MATIC\" : \"OUT\",\n\t\t\tState: state,\n\t\t\tpreviousTime: game.endTimestamp,\n\t\t\tmin: min,\n\t\t\tTimeLeft:\n\t\t\t\tMath.floor((game.endTimestamp - Math.floor(Date.now() / 1000)) / 60) >= 0\n\t\t\t\t\t? \"Time left : \" + String(Math.floor((game.endTimestamp - Math.floor(Date.now() / 1000)) / 60)) + \" : \" + min\n\t\t\t\t\t: \"Calculating\"\n\t\t})\n\t}\n\tconst [counter, setCounter] = useState(0)\n\tuseEffect(() => {\n\t\tgetGameInfos(idCurrentGame)\n\t}, [])\n\treturn (\n\t\t<Container style={gameInfos.State === \"UP\" ? { border: \"3px solid rgb(39, 255, 96)\" } : { border: \"3px solid rgb(255, 67, 67)\" }}>\n\t\t\t<StatusContainer>\n\t\t\t\t<State>Live</State>\n\t\t\t\t<Time>{gameInfos.TimeLeft}</Time>\n\t\t\t\t<Id>#{gameInfos.CurrentGameId}</Id>\n\t\t\t</StatusContainer>\n\t\t\t<Up\n\t\t\t\tstyle={\n\t\t\t\t\tgameInfos.State === \"UP\"\n\t\t\t\t\t\t? {}\n\t\t\t\t\t\t: {\n\t\t\t\t\t\t\t\tbackground: \"linear-gradient(90deg, rgb(206, 162, 206) 0%, rgb(149, 177, 254) 100%)\",\n\t\t\t\t\t\t\t\tcolor: \"rgb(84, 36, 50)\",\n\t\t\t\t\t\t\t\tborder: \"3px solid rgb(84, 36, 50)\"\n\t\t\t\t\t\t  }\n\t\t\t\t}>\n\t\t\t\tUP x{gameInfos.Pool1Payout} Payout\n\t\t\t</Up>\n\t\t\t<StatsContainer>\n\t\t\t\t<Stats>\n\t\t\t\t\t<Key>Current ETH price</Key>\n\t\t\t\t\t<Value style={gameInfos.State === \"UP\" ? { border: \"3px solid rgb(39, 255, 96)\" } : { border: \"3px solid rgb(255, 67, 67)\" }}>\n\t\t\t\t\t\t{gameInfos.CurrentPrice} $\n\t\t\t\t\t</Value>\n\t\t\t\t</Stats>\n\t\t\t\t<Stats>\n\t\t\t\t\t<Key>Locked ETH price</Key>\n\t\t\t\t\t<Value>{gameInfos.priceStart} $</Value>\n\t\t\t\t</Stats>\n\t\t\t\t<Stats>\n\t\t\t\t\t<Key>Prize pool</Key>\n\t\t\t\t\t<Value>\n\t\t\t\t\t\t{parseFloat(gameInfos.Pool0Amount) + parseFloat(gameInfos.Pool1Amount) > 0\n\t\t\t\t\t\t\t? (parseFloat(gameInfos.Pool0Amount) + parseFloat(gameInfos.Pool1Amount)).toFixed(2)\n\t\t\t\t\t\t\t: 0}{\" \"}\n\t\t\t\t\t\tMATIC\n\t\t\t\t\t</Value>\n\t\t\t\t</Stats>\n\t\t\t</StatsContainer>\n\t\t\t<Down\n\t\t\t\tstyle={\n\t\t\t\t\tgameInfos.State === \"DOWN\"\n\t\t\t\t\t\t? {}\n\t\t\t\t\t\t: {\n\t\t\t\t\t\t\t\tbackground: \"linear-gradient(90deg, rgb(206, 162, 206) 0%, rgb(149, 177, 254) 100%)\",\n\t\t\t\t\t\t\t\tcolor: \"rgb(84, 36, 50)\",\n\t\t\t\t\t\t\t\tborder: \"3px solid rgb(84, 36, 50)\"\n\t\t\t\t\t\t  }\n\t\t\t\t}>\n\t\t\t\tDOWN x{gameInfos.Pool0Payout} Payout\n\t\t\t</Down>\n\t\t\t<OutputContainer>\n\t\t\t\t<Output>{gameInfos.playerState}</Output>\n\t\t\t</OutputContainer>\n\t\t</Container>\n\t)\n}\n\nconst Container = styled.div`\n\tbackground-image: linear-gradient(90deg, rgb(206, 162, 206) 0%, rgb(149, 177, 254) 100%);\n\tcolor: rgb(84, 36, 50);\n\tmargin-top: 5rem;\n\twidth: 400px;\n\theight: 350px;\n\tborder-radius: 1rem;\n\tdisplay: flex;\n\tflex-direction: column;\n\tfont-family: Inter, sans-serif;\n\tflex-direction: column;\n`\n\nconst StatusContainer = styled.div`\n\tbackground-color: #191b1f;\n\tborder: #191b1f;\n\tpadding: 0.5rem;\n\tborder-radius: 0.5rem;\n\tdisplay: flex;\n\twidth: 100%;\n\theight: 100%;\n`\n\nconst State = styled.div`\n\twidth: 33%;\n\ttext-align: center;\n\tcolor: rgb(149, 177, 254);\n`\n\nconst Time = styled.div`\n\twidth: 33%;\n\ttext-align: center;\n\tcolor: rgb(149, 177, 254);\n`\n\nconst Id = styled.div`\n\twidth: 33%;\n\ttext-align: center;\n\tcolor: rgb(149, 177, 254);\n`\n\nconst Up = styled.div`\n\tpadding: 0.5rem;\n\tborder-radius: 0.5rem;\n\twidth: 100%;\n\tborder: 3px solid rgb(39, 255, 96);\n\tbackground: rgb(149, 177, 254);\n\tcolor: rgb(39, 255, 96);\n\ttext-align: center;\n`\n\nconst Down = styled.div`\n\tpadding: 0.5rem;\n\tborder-radius: 0.5rem;\n\twidth: 100%;\n\tborder: 3px solid rgb(255, 67, 67);\n\tbackground: rgb(206, 162, 206);\n\tcolor: rgb(255, 67, 67);\n\ttext-align: center;\n`\n\nconst StatsContainer = styled.div`\n\tbackground-color: #191b1f;\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tjustify-content: center;\n\tborder-radius: 0.5rem;\n`\n\nconst Stats = styled.div`\n\tpadding: 0.7rem;\n\tborder-radius: 0.5rem;\n\tdisplay: flex;\n\twidth: 100%;\n`\n\nconst Key = styled.div`\n\tbackground-color: rgb(33, 36, 41);\n\tborder: 1px solid rgb(33, 36, 41);\n\tpadding: 0.5rem;\n\tborder-radius: 0.5rem;\n\twidth: 100%;\n\ttext-align: center;\n\tcolor: rgb(149, 177, 254);\n`\n\nconst Value = styled.div`\n\tcolor: rgb(149, 177, 254);\n\tborder: 1px solid rgb(33, 36, 41);\n\tpadding: 0.5rem;\n\tborder-radius: 0.5rem;\n\twidth: 60%;\n\ttext-align: center;\n`\n\nconst OutputContainer = styled.div`\n\tbackground-image: linear-gradient(90deg, rgb(206, 162, 206) 0%, rgb(149, 177, 254) 100%);\n\tborder: 1px solid linear-gradient(90deg, rgb(206, 162, 206) 0%, rgb(149, 177, 254) 100%);\n\tpadding: 0.5rem;\n\tborder-radius: 0.5rem;\n\twidth: 100%;\n\theight: 10%;\n\tjustify-content: center;\n`\n\nconst Output = styled.p`\n\ttext-align: center;\n`\n\nexport default CurrentGame\n"]},"metadata":{},"sourceType":"module"}