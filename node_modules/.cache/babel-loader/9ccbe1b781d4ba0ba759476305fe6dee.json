{"ast":null,"code":"function _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nimport React, { forwardRef, useRef, useImperativeHandle, useState, useEffect } from 'react';\nimport { classNames, getExtraAttrs, emit } from '../shared/utils';\nimport { f7 } from '../shared/f7';\nvar PieChart = /*#__PURE__*/forwardRef(function (props, ref) {\n  var className = props.className,\n      id = props.id,\n      style = props.style,\n      _props$size = props.size,\n      size = _props$size === void 0 ? 320 : _props$size,\n      _props$tooltip = props.tooltip,\n      tooltip = _props$tooltip === void 0 ? false : _props$tooltip,\n      _props$datasets = props.datasets,\n      datasets = _props$datasets === void 0 ? [] : _props$datasets,\n      formatTooltip = props.formatTooltip,\n      children = props.children;\n  var extraAttrs = getExtraAttrs(props);\n\n  var _useState = useState(null),\n      currentIndex = _useState[0],\n      setCurrentIndex = _useState[1];\n\n  var previousIndex = useRef(null);\n  var elRef = useRef(null);\n  var f7Tooltip = useRef(null);\n  useImperativeHandle(ref, function () {\n    return {\n      el: elRef.current\n    };\n  });\n\n  var getSummValue = function getSummValue() {\n    var summ = 0;\n    datasets.map(function (d) {\n      return d.value || 0;\n    }).forEach(function (value) {\n      summ += value;\n    });\n    return summ;\n  };\n\n  var getPaths = function getPaths() {\n    var paths = [];\n    var cumulativePercentage = 0;\n\n    function getCoordinatesForPercentage(percentage) {\n      var x = Math.cos(2 * Math.PI * percentage) * (size / 3);\n      var y = Math.sin(2 * Math.PI * percentage) * (size / 3);\n      return [x, y];\n    }\n\n    datasets.forEach(function (_ref) {\n      var value = _ref.value,\n          label = _ref.label,\n          color = _ref.color;\n      var percentage = value / getSummValue();\n\n      var _getCoordinatesForPer = getCoordinatesForPercentage(cumulativePercentage),\n          startX = _getCoordinatesForPer[0],\n          startY = _getCoordinatesForPer[1];\n\n      cumulativePercentage += percentage;\n\n      var _getCoordinatesForPer2 = getCoordinatesForPercentage(cumulativePercentage),\n          endX = _getCoordinatesForPer2[0],\n          endY = _getCoordinatesForPer2[1];\n\n      var largeArcFlag = percentage > 0.5 ? 1 : 0;\n      var points = [\"M \" + startX + \" \" + startY, // Move\n      \"A \" + size / 3 + \" \" + size / 3 + \" 0 \" + largeArcFlag + \" 1 \" + endX + \" \" + endY, // Arc\n      'L 0 0' // Line\n      ].join(' ');\n      paths.push({\n        points: points,\n        label: label,\n        color: color\n      });\n    });\n    return paths;\n  };\n\n  var formatTooltipText = function formatTooltipText() {\n    if (currentIndex === null) return '';\n    var _datasets$currentInde = datasets[currentIndex],\n        value = _datasets$currentInde.value,\n        label = _datasets$currentInde.label,\n        color = _datasets$currentInde.color;\n    var percentage = value / getSummValue() * 100;\n\n    var round = function round(v) {\n      if (parseInt(v, 10) === v) return v;\n      return Math.round(v * 100) / 100;\n    };\n\n    if (formatTooltip) {\n      return formatTooltip({\n        index: currentIndex,\n        value: value,\n        label: label,\n        color: color,\n        percentage: percentage\n      });\n    }\n\n    var tooltipText = \"\" + (label ? label + \": \" : '') + round(value) + \" (\" + round(percentage) + \"%)\";\n    return \"\\n      <div class=\\\"pie-chart-tooltip-label\\\">\\n        <span class=\\\"pie-chart-tooltip-color\\\" style=\\\"background-color: \" + color + \";\\\"></span> \" + tooltipText + \"\\n      </div>\\n    \";\n  };\n\n  var setTooltip = function setTooltip() {\n    if (currentIndex === null && !f7Tooltip.current) return;\n    if (!tooltip || !elRef.current || !f7) return;\n\n    if (currentIndex !== null && !f7Tooltip.current) {\n      f7Tooltip.current = f7.tooltip.create({\n        trigger: 'manual',\n        containerEl: elRef.current,\n        targetEl: elRef.current.querySelector(\"path[data-index=\\\"\" + currentIndex + \"\\\"]\"),\n        text: formatTooltipText(),\n        cssClass: 'pie-chart-tooltip'\n      });\n      f7Tooltip.current.show();\n      return;\n    }\n\n    if (!f7Tooltip.current) return;\n\n    if (currentIndex !== null) {\n      f7Tooltip.current.setText(formatTooltipText());\n      f7Tooltip.current.setTargetEl(elRef.current.querySelector(\"path[data-index=\\\"\" + currentIndex + \"\\\"]\"));\n      f7Tooltip.current.show();\n    } else {\n      f7Tooltip.current.hide();\n    }\n  };\n\n  useEffect(function () {\n    if (previousIndex.current === currentIndex) return;\n    previousIndex.current = currentIndex;\n    emit(props, 'select', currentIndex, datasets[currentIndex]);\n    setTooltip();\n  }, [currentIndex]);\n  useEffect(function () {\n    return function () {\n      if (f7Tooltip.current && f7Tooltip.current.destroy) {\n        f7Tooltip.current.destroy();\n      }\n\n      f7Tooltip.current = null;\n    };\n  }, []);\n  var classes = classNames('pie-chart', className);\n  var paths = getPaths();\n  return /*#__PURE__*/React.createElement(\"div\", _extends({\n    id: id,\n    style: style,\n    className: classes,\n    ref: elRef\n  }, extraAttrs), /*#__PURE__*/React.createElement(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: size,\n    height: size,\n    viewBox: \"-\" + size / 3 + \" -\" + size / 3 + \" \" + size * 2 / 3 + \" \" + size * 2 / 3,\n    style: {\n      transform: 'rotate(-90deg)'\n    }\n  }, paths.map(function (path, index) {\n    return /*#__PURE__*/React.createElement(\"path\", {\n      key: path.label || index,\n      d: path.points,\n      fill: path.color,\n      \"data-index\": index,\n      className: classNames({\n        'pie-chart-hidden': currentIndex !== null && currentIndex !== index\n      }),\n      onClick: function onClick() {\n        return setCurrentIndex(index);\n      },\n      onMouseEnter: function onMouseEnter() {\n        return setCurrentIndex(index);\n      },\n      onMouseLeave: function onMouseLeave() {\n        return setCurrentIndex(null);\n      }\n    });\n  })), children);\n});\nPieChart.displayName = 'f7-pie-chart';\nexport default PieChart;","map":{"version":3,"sources":["/Users/gianningamy/cryptobet/front-end/master/node_modules/framework7-react/esm/components/pie-chart.js"],"names":["_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","React","forwardRef","useRef","useImperativeHandle","useState","useEffect","classNames","getExtraAttrs","emit","f7","PieChart","props","ref","className","id","style","_props$size","size","_props$tooltip","tooltip","_props$datasets","datasets","formatTooltip","children","extraAttrs","_useState","currentIndex","setCurrentIndex","previousIndex","elRef","f7Tooltip","el","current","getSummValue","summ","map","d","value","forEach","getPaths","paths","cumulativePercentage","getCoordinatesForPercentage","percentage","x","Math","cos","PI","y","sin","_ref","label","color","_getCoordinatesForPer","startX","startY","_getCoordinatesForPer2","endX","endY","largeArcFlag","points","join","push","formatTooltipText","_datasets$currentInde","round","v","parseInt","index","tooltipText","setTooltip","create","trigger","containerEl","targetEl","querySelector","text","cssClass","show","setText","setTargetEl","hide","destroy","classes","createElement","xmlns","width","height","viewBox","transform","path","fill","onClick","onMouseEnter","onMouseLeave","displayName"],"mappings":"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","sourcesContent":["function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React, { forwardRef, useRef, useImperativeHandle, useState, useEffect } from 'react';\nimport { classNames, getExtraAttrs, emit } from '../shared/utils';\nimport { f7 } from '../shared/f7';\n\nvar PieChart = /*#__PURE__*/forwardRef(function (props, ref) {\n  var className = props.className,\n      id = props.id,\n      style = props.style,\n      _props$size = props.size,\n      size = _props$size === void 0 ? 320 : _props$size,\n      _props$tooltip = props.tooltip,\n      tooltip = _props$tooltip === void 0 ? false : _props$tooltip,\n      _props$datasets = props.datasets,\n      datasets = _props$datasets === void 0 ? [] : _props$datasets,\n      formatTooltip = props.formatTooltip,\n      children = props.children;\n  var extraAttrs = getExtraAttrs(props);\n\n  var _useState = useState(null),\n      currentIndex = _useState[0],\n      setCurrentIndex = _useState[1];\n\n  var previousIndex = useRef(null);\n  var elRef = useRef(null);\n  var f7Tooltip = useRef(null);\n  useImperativeHandle(ref, function () {\n    return {\n      el: elRef.current\n    };\n  });\n\n  var getSummValue = function getSummValue() {\n    var summ = 0;\n    datasets.map(function (d) {\n      return d.value || 0;\n    }).forEach(function (value) {\n      summ += value;\n    });\n    return summ;\n  };\n\n  var getPaths = function getPaths() {\n    var paths = [];\n    var cumulativePercentage = 0;\n\n    function getCoordinatesForPercentage(percentage) {\n      var x = Math.cos(2 * Math.PI * percentage) * (size / 3);\n      var y = Math.sin(2 * Math.PI * percentage) * (size / 3);\n      return [x, y];\n    }\n\n    datasets.forEach(function (_ref) {\n      var value = _ref.value,\n          label = _ref.label,\n          color = _ref.color;\n      var percentage = value / getSummValue();\n\n      var _getCoordinatesForPer = getCoordinatesForPercentage(cumulativePercentage),\n          startX = _getCoordinatesForPer[0],\n          startY = _getCoordinatesForPer[1];\n\n      cumulativePercentage += percentage;\n\n      var _getCoordinatesForPer2 = getCoordinatesForPercentage(cumulativePercentage),\n          endX = _getCoordinatesForPer2[0],\n          endY = _getCoordinatesForPer2[1];\n\n      var largeArcFlag = percentage > 0.5 ? 1 : 0;\n      var points = [\"M \" + startX + \" \" + startY, // Move\n      \"A \" + size / 3 + \" \" + size / 3 + \" 0 \" + largeArcFlag + \" 1 \" + endX + \" \" + endY, // Arc\n      'L 0 0' // Line\n      ].join(' ');\n      paths.push({\n        points: points,\n        label: label,\n        color: color\n      });\n    });\n    return paths;\n  };\n\n  var formatTooltipText = function formatTooltipText() {\n    if (currentIndex === null) return '';\n    var _datasets$currentInde = datasets[currentIndex],\n        value = _datasets$currentInde.value,\n        label = _datasets$currentInde.label,\n        color = _datasets$currentInde.color;\n    var percentage = value / getSummValue() * 100;\n\n    var round = function round(v) {\n      if (parseInt(v, 10) === v) return v;\n      return Math.round(v * 100) / 100;\n    };\n\n    if (formatTooltip) {\n      return formatTooltip({\n        index: currentIndex,\n        value: value,\n        label: label,\n        color: color,\n        percentage: percentage\n      });\n    }\n\n    var tooltipText = \"\" + (label ? label + \": \" : '') + round(value) + \" (\" + round(percentage) + \"%)\";\n    return \"\\n      <div class=\\\"pie-chart-tooltip-label\\\">\\n        <span class=\\\"pie-chart-tooltip-color\\\" style=\\\"background-color: \" + color + \";\\\"></span> \" + tooltipText + \"\\n      </div>\\n    \";\n  };\n\n  var setTooltip = function setTooltip() {\n    if (currentIndex === null && !f7Tooltip.current) return;\n    if (!tooltip || !elRef.current || !f7) return;\n\n    if (currentIndex !== null && !f7Tooltip.current) {\n      f7Tooltip.current = f7.tooltip.create({\n        trigger: 'manual',\n        containerEl: elRef.current,\n        targetEl: elRef.current.querySelector(\"path[data-index=\\\"\" + currentIndex + \"\\\"]\"),\n        text: formatTooltipText(),\n        cssClass: 'pie-chart-tooltip'\n      });\n      f7Tooltip.current.show();\n      return;\n    }\n\n    if (!f7Tooltip.current) return;\n\n    if (currentIndex !== null) {\n      f7Tooltip.current.setText(formatTooltipText());\n      f7Tooltip.current.setTargetEl(elRef.current.querySelector(\"path[data-index=\\\"\" + currentIndex + \"\\\"]\"));\n      f7Tooltip.current.show();\n    } else {\n      f7Tooltip.current.hide();\n    }\n  };\n\n  useEffect(function () {\n    if (previousIndex.current === currentIndex) return;\n    previousIndex.current = currentIndex;\n    emit(props, 'select', currentIndex, datasets[currentIndex]);\n    setTooltip();\n  }, [currentIndex]);\n  useEffect(function () {\n    return function () {\n      if (f7Tooltip.current && f7Tooltip.current.destroy) {\n        f7Tooltip.current.destroy();\n      }\n\n      f7Tooltip.current = null;\n    };\n  }, []);\n  var classes = classNames('pie-chart', className);\n  var paths = getPaths();\n  return /*#__PURE__*/React.createElement(\"div\", _extends({\n    id: id,\n    style: style,\n    className: classes,\n    ref: elRef\n  }, extraAttrs), /*#__PURE__*/React.createElement(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: size,\n    height: size,\n    viewBox: \"-\" + size / 3 + \" -\" + size / 3 + \" \" + size * 2 / 3 + \" \" + size * 2 / 3,\n    style: {\n      transform: 'rotate(-90deg)'\n    }\n  }, paths.map(function (path, index) {\n    return /*#__PURE__*/React.createElement(\"path\", {\n      key: path.label || index,\n      d: path.points,\n      fill: path.color,\n      \"data-index\": index,\n      className: classNames({\n        'pie-chart-hidden': currentIndex !== null && currentIndex !== index\n      }),\n      onClick: function onClick() {\n        return setCurrentIndex(index);\n      },\n      onMouseEnter: function onMouseEnter() {\n        return setCurrentIndex(index);\n      },\n      onMouseLeave: function onMouseLeave() {\n        return setCurrentIndex(null);\n      }\n    });\n  })), children);\n});\nPieChart.displayName = 'f7-pie-chart';\nexport default PieChart;"]},"metadata":{},"sourceType":"module"}