{"ast":null,"code":"function _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nimport React, { forwardRef, useRef, useImperativeHandle, useState, useEffect } from 'react';\nimport { classNames, getExtraAttrs, emit } from '../shared/utils';\nimport { f7 } from '../shared/f7';\nvar AreaChart = /*#__PURE__*/forwardRef(function (props, ref) {\n  var className = props.className,\n      id = props.id,\n      style = props.style,\n      _props$lineChart = props.lineChart,\n      lineChart = _props$lineChart === void 0 ? false : _props$lineChart,\n      _props$datasets = props.datasets,\n      datasets = _props$datasets === void 0 ? [] : _props$datasets,\n      _props$axis = props.axis,\n      axis = _props$axis === void 0 ? false : _props$axis,\n      _props$axisLabels = props.axisLabels,\n      axisLabels = _props$axisLabels === void 0 ? [] : _props$axisLabels,\n      _props$tooltip = props.tooltip,\n      tooltip = _props$tooltip === void 0 ? false : _props$tooltip,\n      _props$legend = props.legend,\n      legend = _props$legend === void 0 ? false : _props$legend,\n      _props$toggleDatasets = props.toggleDatasets,\n      toggleDatasets = _props$toggleDatasets === void 0 ? false : _props$toggleDatasets,\n      _props$width = props.width,\n      width = _props$width === void 0 ? 640 : _props$width,\n      _props$height = props.height,\n      height = _props$height === void 0 ? 320 : _props$height,\n      _props$maxAxisLabels = props.maxAxisLabels,\n      maxAxisLabels = _props$maxAxisLabels === void 0 ? 8 : _props$maxAxisLabels,\n      formatAxisLabelProp = props.formatAxisLabel,\n      formatLegendLabelProp = props.formatLegendLabel,\n      formatTooltipProp = props.formatTooltip,\n      formatTooltipAxisLabel = props.formatTooltipAxisLabel,\n      formatTooltipTotal = props.formatTooltipTotal,\n      formatTooltipDataset = props.formatTooltipDataset,\n      children = props.children;\n\n  var _useState = useState(null),\n      currentIndex = _useState[0],\n      setCurrentIndex = _useState[1];\n\n  var previousIndex = useRef(null);\n\n  var _useState2 = useState([]),\n      hiddenDatasets = _useState2[0],\n      setHiddenDatasets = _useState2[1];\n\n  var extraAttrs = getExtraAttrs(props);\n  var elRef = useRef(null);\n  var svgElRef = useRef(null);\n  var f7Tooltip = useRef(null);\n  var linesOffsets = useRef(null);\n  useImperativeHandle(ref, function () {\n    return {\n      el: elRef.current\n    };\n  });\n\n  var getVisibleLegends = function getVisibleLegends() {\n    if (!maxAxisLabels || axisLabels.length <= maxAxisLabels) return axisLabels;\n    var skipStep = Math.ceil(axisLabels.length / maxAxisLabels);\n    var filtered = axisLabels.filter(function (label, index) {\n      return index % skipStep === 0;\n    });\n    return filtered;\n  };\n\n  var getSummValues = function getSummValues() {\n    var summValues = [];\n    datasets.filter(function (dataset, index) {\n      return !hiddenDatasets.includes(index);\n    }).forEach(function (_ref) {\n      var values = _ref.values;\n      values.forEach(function (value, valueIndex) {\n        if (!summValues[valueIndex]) summValues[valueIndex] = 0;\n        summValues[valueIndex] += value;\n      });\n    });\n    return summValues;\n  };\n\n  var getChartData = function getChartData() {\n    var data = [];\n\n    if (!datasets.length) {\n      return data;\n    }\n\n    var lastValues = datasets[0].values.map(function () {\n      return 0;\n    });\n    var maxValue = 0;\n\n    if (lineChart) {\n      datasets.forEach(function (_ref2) {\n        var values = _ref2.values;\n        var datasetMaxValue = Math.max.apply(Math, values);\n        if (datasetMaxValue > maxValue) maxValue = datasetMaxValue;\n      });\n    } else {\n      maxValue = Math.max.apply(Math, getSummValues());\n    }\n\n    datasets.filter(function (dataset, index) {\n      return !hiddenDatasets.includes(index);\n    }).forEach(function (_ref3) {\n      var label = _ref3.label,\n          values = _ref3.values,\n          color = _ref3.color;\n      var points = values.map(function (originalValue, valueIndex) {\n        lastValues[valueIndex] += originalValue;\n        var value = lineChart ? originalValue : lastValues[valueIndex];\n        var x = valueIndex / (values.length - 1) * width;\n        var y = height - value / maxValue * height;\n\n        if (lineChart) {\n          return \"\" + (valueIndex === 0 ? 'M' : 'L') + x + \",\" + y;\n        }\n\n        return x + \" \" + y;\n      });\n\n      if (!lineChart) {\n        points.push(width + \" \" + height + \" 0 \" + height);\n      }\n\n      data.push({\n        label: label,\n        points: points.join(' '),\n        color: color\n      });\n    });\n    return data.reverse();\n  };\n\n  var getVerticalLines = function getVerticalLines() {\n    var lines = [];\n\n    if (!datasets.length) {\n      return lines;\n    }\n\n    var values = datasets[0].values;\n    values.forEach(function (value, valueIndex) {\n      var x = valueIndex / (values.length - 1) * width;\n      lines.push(x);\n    });\n    return lines;\n  };\n\n  var toggleDataset = function toggleDataset(index) {\n    if (!toggleDatasets) return;\n\n    if (hiddenDatasets.includes(index)) {\n      hiddenDatasets.splice(hiddenDatasets.indexOf(index), 1);\n    } else {\n      hiddenDatasets.push(index);\n    }\n\n    setHiddenDatasets([].concat(hiddenDatasets));\n  };\n\n  var formatAxisLabel = function formatAxisLabel(label) {\n    if (formatAxisLabelProp) return formatAxisLabelProp(label);\n    return label;\n  };\n\n  var formatLegendLabel = function formatLegendLabel(label) {\n    if (formatLegendLabelProp) return formatLegendLabelProp(label);\n    return label;\n  };\n\n  var calcLinesOffsets = function calcLinesOffsets() {\n    var lines = svgElRef.current.querySelectorAll('line');\n    linesOffsets.current = [];\n\n    for (var i = 0; i < lines.length; i += 1) {\n      linesOffsets.current.push(lines[i].getBoundingClientRect().left);\n    }\n  };\n\n  var formatTooltip = function formatTooltip() {\n    if (currentIndex === null) return '';\n    var total = 0;\n    var currentValues = datasets.filter(function (dataset, index) {\n      return !hiddenDatasets.includes(index);\n    }).map(function (dataset) {\n      return {\n        color: dataset.color,\n        label: dataset.label,\n        value: dataset.values[currentIndex]\n      };\n    });\n    currentValues.forEach(function (dataset) {\n      total += dataset.value;\n    });\n\n    if (formatTooltipProp) {\n      return formatTooltipProp({\n        index: currentIndex,\n        total: total,\n        datasets: currentValues\n      });\n    }\n\n    var labelText = formatTooltipAxisLabel ? formatTooltipAxisLabel(axisLabels[currentIndex]) : formatAxisLabel(axisLabels[currentIndex]);\n    if (!labelText) labelText = '';\n    var totalText = formatTooltipTotal ? formatTooltipTotal(total) : total; // prettier-ignore\n\n    var datasetsText = currentValues.length > 0 ? \"\\n      <ul class=\\\"area-chart-tooltip-list\\\">\\n        \" + currentValues.map(function (_ref4) {\n      var label = _ref4.label,\n          color = _ref4.color,\n          value = _ref4.value;\n      var valueText = formatTooltipDataset ? formatTooltipDataset(label, value, color) : label + \": \" + value;\n      return \"\\n              <li><span style=\\\"background-color: \" + color + \";\\\"></span>\" + valueText + \"</li>\\n            \";\n    }).join('') + \"\\n      </ul>\" : ''; // prettier-ignore\n\n    return \"\\n      <div class=\\\"area-chart-tooltip-label\\\">\" + labelText + \"</div>\\n      <div class=\\\"area-chart-tooltip-total\\\">\" + totalText + \"</div>\\n      \" + datasetsText + \"\\n    \";\n  };\n\n  var setTooltip = function setTooltip() {\n    if (!tooltip) return;\n    var hasVisibleDataSets = datasets.filter(function (dataset, index) {\n      return !hiddenDatasets.includes(index);\n    }).length > 0;\n\n    if (!hasVisibleDataSets) {\n      if (f7Tooltip.current && f7Tooltip.current.hide) f7Tooltip.current.hide();\n      return;\n    }\n\n    if (currentIndex !== null && !f7Tooltip.current) {\n      f7Tooltip.current = f7.tooltip.create({\n        trigger: 'manual',\n        containerEl: elRef.current,\n        targetEl: svgElRef.current.querySelector(\"line[data-index=\\\"\" + currentIndex + \"\\\"]\"),\n        text: formatTooltip(),\n        cssClass: 'area-chart-tooltip'\n      });\n\n      if (f7Tooltip.current && f7Tooltip.current.show) {\n        f7Tooltip.current.show();\n      }\n\n      return;\n    }\n\n    if (!f7Tooltip.current || !f7Tooltip.current.hide || !f7Tooltip.current.show) {\n      return;\n    }\n\n    if (currentIndex !== null) {\n      f7Tooltip.current.setText(formatTooltip());\n      f7Tooltip.current.setTargetEl(svgElRef.current.querySelector(\"line[data-index=\\\"\" + currentIndex + \"\\\"]\"));\n      f7Tooltip.current.show();\n    } else {\n      f7Tooltip.current.hide();\n    }\n  };\n\n  var onMouseEnter = function onMouseEnter() {\n    calcLinesOffsets();\n  };\n\n  var onMouseMove = function onMouseMove(e) {\n    if (!linesOffsets.current) {\n      calcLinesOffsets();\n    }\n\n    var currentLeft = e.pageX;\n    if (typeof currentLeft === 'undefined') currentLeft = 0;\n    var distances = linesOffsets.current.map(function (left) {\n      return Math.abs(currentLeft - left);\n    });\n    var minDistance = Math.min.apply(Math, distances);\n    var closestIndex = distances.indexOf(minDistance);\n    setCurrentIndex(closestIndex);\n  };\n\n  var onMouseLeave = function onMouseLeave() {\n    setCurrentIndex(null);\n  };\n\n  var attachEvents = function attachEvents() {\n    if (!svgElRef.current) return;\n    svgElRef.current.addEventListener('mouseenter', onMouseEnter);\n    svgElRef.current.addEventListener('mousemove', onMouseMove);\n    svgElRef.current.addEventListener('mouseleave', onMouseLeave);\n  };\n\n  var detachEvents = function detachEvents() {\n    if (!svgElRef.current) return;\n    svgElRef.current.removeEventListener('mouseenter', onMouseEnter);\n    svgElRef.current.removeEventListener('mousemove', onMouseMove);\n    svgElRef.current.removeEventListener('mouseleave', onMouseLeave);\n  };\n\n  useEffect(function () {\n    if (previousIndex.current === currentIndex) return;\n    previousIndex.current = currentIndex;\n    emit(props, 'select', currentIndex);\n    setTooltip();\n  }, [currentIndex]);\n  useEffect(function () {\n    attachEvents();\n    return detachEvents;\n  });\n  useEffect(function () {\n    return function () {\n      if (f7Tooltip.current && f7Tooltip.current.destroy) {\n        f7Tooltip.current.destroy();\n      }\n\n      f7Tooltip.current = null;\n    };\n  }, []);\n  var classes = classNames('area-chart', className);\n  var chartData = getChartData();\n  var verticalLines = getVerticalLines();\n  var visibleLegends = getVisibleLegends();\n  var LegendItemTag = toggleDatasets ? 'button' : 'span';\n  var ChartTag = lineChart ? 'path' : 'polygon';\n  return /*#__PURE__*/React.createElement(\"div\", _extends({\n    id: id,\n    style: style,\n    className: classes,\n    ref: elRef\n  }, extraAttrs), /*#__PURE__*/React.createElement(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: width,\n    height: height,\n    viewBox: \"0 0 \" + width + \" \" + height,\n    preserveAspectRatio: \"none\",\n    ref: svgElRef\n  }, chartData.map(function (data, index) {\n    return /*#__PURE__*/React.createElement(ChartTag, {\n      key: ChartTag + \"-\" + index,\n      fill: lineChart ? undefined : data.color,\n      stroke: lineChart ? data.color : undefined,\n      fillRule: \"evenodd\",\n      points: lineChart ? undefined : data.points,\n      d: lineChart ? data.points : undefined\n    });\n  }), verticalLines.map(function (line, index) {\n    return /*#__PURE__*/React.createElement(\"line\", {\n      key: \"line-\" + index,\n      \"data-index\": index,\n      fill: \"#000\",\n      x1: line,\n      y1: 0,\n      x2: line,\n      y2: height,\n      className: classNames({\n        'area-chart-current-line': currentIndex === index\n      })\n    });\n  })), axis && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"area-chart-axis\"\n  }, axisLabels.map(function (label, index) {\n    return /*#__PURE__*/React.createElement(\"span\", {\n      key: index\n    }, visibleLegends.includes(label) && /*#__PURE__*/React.createElement(\"span\", null, formatAxisLabel(label)));\n  })), legend && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"area-chart-legend\"\n  }, datasets.map(function (dataset, index) {\n    return /*#__PURE__*/React.createElement(LegendItemTag, {\n      key: index,\n      className: classNames('area-chart-legend-item', {\n        'area-chart-legend-item-hidden': hiddenDatasets.includes(index),\n        'area-chart-legend-button': toggleDatasets\n      }),\n      type: toggleDatasets ? 'button' : undefined,\n      onClick: function onClick() {\n        return toggleDataset(index);\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      style: {\n        backgroundColor: dataset.color\n      }\n    }), formatLegendLabel(dataset.label));\n  })), children);\n});\nAreaChart.displayName = 'f7-area-chart';\nexport default AreaChart;","map":{"version":3,"sources":["/Users/gianningamy/cryptobet/front-end/master/node_modules/framework7-react/esm/components/area-chart.js"],"names":["_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","React","forwardRef","useRef","useImperativeHandle","useState","useEffect","classNames","getExtraAttrs","emit","f7","AreaChart","props","ref","className","id","style","_props$lineChart","lineChart","_props$datasets","datasets","_props$axis","axis","_props$axisLabels","axisLabels","_props$tooltip","tooltip","_props$legend","legend","_props$toggleDatasets","toggleDatasets","_props$width","width","_props$height","height","_props$maxAxisLabels","maxAxisLabels","formatAxisLabelProp","formatAxisLabel","formatLegendLabelProp","formatLegendLabel","formatTooltipProp","formatTooltip","formatTooltipAxisLabel","formatTooltipTotal","formatTooltipDataset","children","_useState","currentIndex","setCurrentIndex","previousIndex","_useState2","hiddenDatasets","setHiddenDatasets","extraAttrs","elRef","svgElRef","f7Tooltip","linesOffsets","el","current","getVisibleLegends","skipStep","Math","ceil","filtered","filter","label","index","getSummValues","summValues","dataset","includes","forEach","_ref","values","value","valueIndex","getChartData","data","lastValues","map","maxValue","_ref2","datasetMaxValue","max","_ref3","color","points","originalValue","x","y","push","join","reverse","getVerticalLines","lines","toggleDataset","splice","indexOf","concat","calcLinesOffsets","querySelectorAll","getBoundingClientRect","left","total","currentValues","labelText","totalText","datasetsText","_ref4","valueText","setTooltip","hasVisibleDataSets","hide","create","trigger","containerEl","targetEl","querySelector","text","cssClass","show","setText","setTargetEl","onMouseEnter","onMouseMove","e","currentLeft","pageX","distances","abs","minDistance","min","closestIndex","onMouseLeave","attachEvents","addEventListener","detachEvents","removeEventListener","destroy","classes","chartData","verticalLines","visibleLegends","LegendItemTag","ChartTag","createElement","xmlns","viewBox","preserveAspectRatio","fill","undefined","stroke","fillRule","d","line","x1","y1","x2","y2","type","onClick","backgroundColor","displayName"],"mappings":"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","sourcesContent":["function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React, { forwardRef, useRef, useImperativeHandle, useState, useEffect } from 'react';\nimport { classNames, getExtraAttrs, emit } from '../shared/utils';\nimport { f7 } from '../shared/f7';\n\nvar AreaChart = /*#__PURE__*/forwardRef(function (props, ref) {\n  var className = props.className,\n      id = props.id,\n      style = props.style,\n      _props$lineChart = props.lineChart,\n      lineChart = _props$lineChart === void 0 ? false : _props$lineChart,\n      _props$datasets = props.datasets,\n      datasets = _props$datasets === void 0 ? [] : _props$datasets,\n      _props$axis = props.axis,\n      axis = _props$axis === void 0 ? false : _props$axis,\n      _props$axisLabels = props.axisLabels,\n      axisLabels = _props$axisLabels === void 0 ? [] : _props$axisLabels,\n      _props$tooltip = props.tooltip,\n      tooltip = _props$tooltip === void 0 ? false : _props$tooltip,\n      _props$legend = props.legend,\n      legend = _props$legend === void 0 ? false : _props$legend,\n      _props$toggleDatasets = props.toggleDatasets,\n      toggleDatasets = _props$toggleDatasets === void 0 ? false : _props$toggleDatasets,\n      _props$width = props.width,\n      width = _props$width === void 0 ? 640 : _props$width,\n      _props$height = props.height,\n      height = _props$height === void 0 ? 320 : _props$height,\n      _props$maxAxisLabels = props.maxAxisLabels,\n      maxAxisLabels = _props$maxAxisLabels === void 0 ? 8 : _props$maxAxisLabels,\n      formatAxisLabelProp = props.formatAxisLabel,\n      formatLegendLabelProp = props.formatLegendLabel,\n      formatTooltipProp = props.formatTooltip,\n      formatTooltipAxisLabel = props.formatTooltipAxisLabel,\n      formatTooltipTotal = props.formatTooltipTotal,\n      formatTooltipDataset = props.formatTooltipDataset,\n      children = props.children;\n\n  var _useState = useState(null),\n      currentIndex = _useState[0],\n      setCurrentIndex = _useState[1];\n\n  var previousIndex = useRef(null);\n\n  var _useState2 = useState([]),\n      hiddenDatasets = _useState2[0],\n      setHiddenDatasets = _useState2[1];\n\n  var extraAttrs = getExtraAttrs(props);\n  var elRef = useRef(null);\n  var svgElRef = useRef(null);\n  var f7Tooltip = useRef(null);\n  var linesOffsets = useRef(null);\n  useImperativeHandle(ref, function () {\n    return {\n      el: elRef.current\n    };\n  });\n\n  var getVisibleLegends = function getVisibleLegends() {\n    if (!maxAxisLabels || axisLabels.length <= maxAxisLabels) return axisLabels;\n    var skipStep = Math.ceil(axisLabels.length / maxAxisLabels);\n    var filtered = axisLabels.filter(function (label, index) {\n      return index % skipStep === 0;\n    });\n    return filtered;\n  };\n\n  var getSummValues = function getSummValues() {\n    var summValues = [];\n    datasets.filter(function (dataset, index) {\n      return !hiddenDatasets.includes(index);\n    }).forEach(function (_ref) {\n      var values = _ref.values;\n      values.forEach(function (value, valueIndex) {\n        if (!summValues[valueIndex]) summValues[valueIndex] = 0;\n        summValues[valueIndex] += value;\n      });\n    });\n    return summValues;\n  };\n\n  var getChartData = function getChartData() {\n    var data = [];\n\n    if (!datasets.length) {\n      return data;\n    }\n\n    var lastValues = datasets[0].values.map(function () {\n      return 0;\n    });\n    var maxValue = 0;\n\n    if (lineChart) {\n      datasets.forEach(function (_ref2) {\n        var values = _ref2.values;\n        var datasetMaxValue = Math.max.apply(Math, values);\n        if (datasetMaxValue > maxValue) maxValue = datasetMaxValue;\n      });\n    } else {\n      maxValue = Math.max.apply(Math, getSummValues());\n    }\n\n    datasets.filter(function (dataset, index) {\n      return !hiddenDatasets.includes(index);\n    }).forEach(function (_ref3) {\n      var label = _ref3.label,\n          values = _ref3.values,\n          color = _ref3.color;\n      var points = values.map(function (originalValue, valueIndex) {\n        lastValues[valueIndex] += originalValue;\n        var value = lineChart ? originalValue : lastValues[valueIndex];\n        var x = valueIndex / (values.length - 1) * width;\n        var y = height - value / maxValue * height;\n\n        if (lineChart) {\n          return \"\" + (valueIndex === 0 ? 'M' : 'L') + x + \",\" + y;\n        }\n\n        return x + \" \" + y;\n      });\n\n      if (!lineChart) {\n        points.push(width + \" \" + height + \" 0 \" + height);\n      }\n\n      data.push({\n        label: label,\n        points: points.join(' '),\n        color: color\n      });\n    });\n    return data.reverse();\n  };\n\n  var getVerticalLines = function getVerticalLines() {\n    var lines = [];\n\n    if (!datasets.length) {\n      return lines;\n    }\n\n    var values = datasets[0].values;\n    values.forEach(function (value, valueIndex) {\n      var x = valueIndex / (values.length - 1) * width;\n      lines.push(x);\n    });\n    return lines;\n  };\n\n  var toggleDataset = function toggleDataset(index) {\n    if (!toggleDatasets) return;\n\n    if (hiddenDatasets.includes(index)) {\n      hiddenDatasets.splice(hiddenDatasets.indexOf(index), 1);\n    } else {\n      hiddenDatasets.push(index);\n    }\n\n    setHiddenDatasets([].concat(hiddenDatasets));\n  };\n\n  var formatAxisLabel = function formatAxisLabel(label) {\n    if (formatAxisLabelProp) return formatAxisLabelProp(label);\n    return label;\n  };\n\n  var formatLegendLabel = function formatLegendLabel(label) {\n    if (formatLegendLabelProp) return formatLegendLabelProp(label);\n    return label;\n  };\n\n  var calcLinesOffsets = function calcLinesOffsets() {\n    var lines = svgElRef.current.querySelectorAll('line');\n    linesOffsets.current = [];\n\n    for (var i = 0; i < lines.length; i += 1) {\n      linesOffsets.current.push(lines[i].getBoundingClientRect().left);\n    }\n  };\n\n  var formatTooltip = function formatTooltip() {\n    if (currentIndex === null) return '';\n    var total = 0;\n    var currentValues = datasets.filter(function (dataset, index) {\n      return !hiddenDatasets.includes(index);\n    }).map(function (dataset) {\n      return {\n        color: dataset.color,\n        label: dataset.label,\n        value: dataset.values[currentIndex]\n      };\n    });\n    currentValues.forEach(function (dataset) {\n      total += dataset.value;\n    });\n\n    if (formatTooltipProp) {\n      return formatTooltipProp({\n        index: currentIndex,\n        total: total,\n        datasets: currentValues\n      });\n    }\n\n    var labelText = formatTooltipAxisLabel ? formatTooltipAxisLabel(axisLabels[currentIndex]) : formatAxisLabel(axisLabels[currentIndex]);\n    if (!labelText) labelText = '';\n    var totalText = formatTooltipTotal ? formatTooltipTotal(total) : total; // prettier-ignore\n\n    var datasetsText = currentValues.length > 0 ? \"\\n      <ul class=\\\"area-chart-tooltip-list\\\">\\n        \" + currentValues.map(function (_ref4) {\n      var label = _ref4.label,\n          color = _ref4.color,\n          value = _ref4.value;\n      var valueText = formatTooltipDataset ? formatTooltipDataset(label, value, color) : label + \": \" + value;\n      return \"\\n              <li><span style=\\\"background-color: \" + color + \";\\\"></span>\" + valueText + \"</li>\\n            \";\n    }).join('') + \"\\n      </ul>\" : ''; // prettier-ignore\n\n    return \"\\n      <div class=\\\"area-chart-tooltip-label\\\">\" + labelText + \"</div>\\n      <div class=\\\"area-chart-tooltip-total\\\">\" + totalText + \"</div>\\n      \" + datasetsText + \"\\n    \";\n  };\n\n  var setTooltip = function setTooltip() {\n    if (!tooltip) return;\n    var hasVisibleDataSets = datasets.filter(function (dataset, index) {\n      return !hiddenDatasets.includes(index);\n    }).length > 0;\n\n    if (!hasVisibleDataSets) {\n      if (f7Tooltip.current && f7Tooltip.current.hide) f7Tooltip.current.hide();\n      return;\n    }\n\n    if (currentIndex !== null && !f7Tooltip.current) {\n      f7Tooltip.current = f7.tooltip.create({\n        trigger: 'manual',\n        containerEl: elRef.current,\n        targetEl: svgElRef.current.querySelector(\"line[data-index=\\\"\" + currentIndex + \"\\\"]\"),\n        text: formatTooltip(),\n        cssClass: 'area-chart-tooltip'\n      });\n\n      if (f7Tooltip.current && f7Tooltip.current.show) {\n        f7Tooltip.current.show();\n      }\n\n      return;\n    }\n\n    if (!f7Tooltip.current || !f7Tooltip.current.hide || !f7Tooltip.current.show) {\n      return;\n    }\n\n    if (currentIndex !== null) {\n      f7Tooltip.current.setText(formatTooltip());\n      f7Tooltip.current.setTargetEl(svgElRef.current.querySelector(\"line[data-index=\\\"\" + currentIndex + \"\\\"]\"));\n      f7Tooltip.current.show();\n    } else {\n      f7Tooltip.current.hide();\n    }\n  };\n\n  var onMouseEnter = function onMouseEnter() {\n    calcLinesOffsets();\n  };\n\n  var onMouseMove = function onMouseMove(e) {\n    if (!linesOffsets.current) {\n      calcLinesOffsets();\n    }\n\n    var currentLeft = e.pageX;\n    if (typeof currentLeft === 'undefined') currentLeft = 0;\n    var distances = linesOffsets.current.map(function (left) {\n      return Math.abs(currentLeft - left);\n    });\n    var minDistance = Math.min.apply(Math, distances);\n    var closestIndex = distances.indexOf(minDistance);\n    setCurrentIndex(closestIndex);\n  };\n\n  var onMouseLeave = function onMouseLeave() {\n    setCurrentIndex(null);\n  };\n\n  var attachEvents = function attachEvents() {\n    if (!svgElRef.current) return;\n    svgElRef.current.addEventListener('mouseenter', onMouseEnter);\n    svgElRef.current.addEventListener('mousemove', onMouseMove);\n    svgElRef.current.addEventListener('mouseleave', onMouseLeave);\n  };\n\n  var detachEvents = function detachEvents() {\n    if (!svgElRef.current) return;\n    svgElRef.current.removeEventListener('mouseenter', onMouseEnter);\n    svgElRef.current.removeEventListener('mousemove', onMouseMove);\n    svgElRef.current.removeEventListener('mouseleave', onMouseLeave);\n  };\n\n  useEffect(function () {\n    if (previousIndex.current === currentIndex) return;\n    previousIndex.current = currentIndex;\n    emit(props, 'select', currentIndex);\n    setTooltip();\n  }, [currentIndex]);\n  useEffect(function () {\n    attachEvents();\n    return detachEvents;\n  });\n  useEffect(function () {\n    return function () {\n      if (f7Tooltip.current && f7Tooltip.current.destroy) {\n        f7Tooltip.current.destroy();\n      }\n\n      f7Tooltip.current = null;\n    };\n  }, []);\n  var classes = classNames('area-chart', className);\n  var chartData = getChartData();\n  var verticalLines = getVerticalLines();\n  var visibleLegends = getVisibleLegends();\n  var LegendItemTag = toggleDatasets ? 'button' : 'span';\n  var ChartTag = lineChart ? 'path' : 'polygon';\n  return /*#__PURE__*/React.createElement(\"div\", _extends({\n    id: id,\n    style: style,\n    className: classes,\n    ref: elRef\n  }, extraAttrs), /*#__PURE__*/React.createElement(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: width,\n    height: height,\n    viewBox: \"0 0 \" + width + \" \" + height,\n    preserveAspectRatio: \"none\",\n    ref: svgElRef\n  }, chartData.map(function (data, index) {\n    return /*#__PURE__*/React.createElement(ChartTag, {\n      key: ChartTag + \"-\" + index,\n      fill: lineChart ? undefined : data.color,\n      stroke: lineChart ? data.color : undefined,\n      fillRule: \"evenodd\",\n      points: lineChart ? undefined : data.points,\n      d: lineChart ? data.points : undefined\n    });\n  }), verticalLines.map(function (line, index) {\n    return /*#__PURE__*/React.createElement(\"line\", {\n      key: \"line-\" + index,\n      \"data-index\": index,\n      fill: \"#000\",\n      x1: line,\n      y1: 0,\n      x2: line,\n      y2: height,\n      className: classNames({\n        'area-chart-current-line': currentIndex === index\n      })\n    });\n  })), axis && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"area-chart-axis\"\n  }, axisLabels.map(function (label, index) {\n    return /*#__PURE__*/React.createElement(\"span\", {\n      key: index\n    }, visibleLegends.includes(label) && /*#__PURE__*/React.createElement(\"span\", null, formatAxisLabel(label)));\n  })), legend && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"area-chart-legend\"\n  }, datasets.map(function (dataset, index) {\n    return /*#__PURE__*/React.createElement(LegendItemTag, {\n      key: index,\n      className: classNames('area-chart-legend-item', {\n        'area-chart-legend-item-hidden': hiddenDatasets.includes(index),\n        'area-chart-legend-button': toggleDatasets\n      }),\n      type: toggleDatasets ? 'button' : undefined,\n      onClick: function onClick() {\n        return toggleDataset(index);\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      style: {\n        backgroundColor: dataset.color\n      }\n    }), formatLegendLabel(dataset.label));\n  })), children);\n});\nAreaChart.displayName = 'f7-area-chart';\nexport default AreaChart;"]},"metadata":{},"sourceType":"module"}